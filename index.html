<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—É–ø–µ—Ä–ø–æ—Å—Ç–∏–Ω–≥ - –í—Ö–æ–¥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #1a1a2e;
            --bg-card: #16213e;
            --accent: #e94560;
            --accent-hover: #ff4666;
            --text-primary: #ffffff;
            --text-secondary: #a8a8b3;
            --border: #2a2a3e;
            --success: #4ade80;
            --warning: #fbbf24;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        html, body {
            height: 100%; 
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Login Page Styles */
        .login-container {
            background: var(--bg-secondary);
            padding: 50px 40px;
            border-radius: 25px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            width: 100%;
            max-width: 450px;
            text-align: center;
            animation: fadeInLogin 0.5s ease-out;
            margin: 20px; 
        }

        @keyframes fadeInLogin {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-logo {
            font-size: 36px;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        .login-logo::before {
            content: "üöÄ";
            font-size: 40px;
            -webkit-text-fill-color: initial; 
        }

        .login-tagline {
            color: var(--text-secondary);
            margin-bottom: 35px;
            font-size: 16px;
            line-height: 1.5;
        }

        .login-form .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        .login-form .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 14px;
        }
        .login-form .form-input {
            width: 100%;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 14px 18px;
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .login-form .form-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(233, 69, 96, 0.1);
        }
        .login-form .btn-login {
            width: 100%;
            background: var(--gradient);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        .login-form .btn-login:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        .login-hint {
            margin-top: 25px;
            font-size: 13px;
            color: var(--text-secondary);
            background-color: rgba(255,255,255,0.05);
            padding: 10px;
            border-radius: 8px;
            border: 1px dashed var(--border);
        }
        .login-error {
            color: var(--accent);
            font-size: 14px;
            margin-top: 15px;
            display: none; 
        }

        /* Main App Styles (Initially Hidden) */
        .container {
            display: none; 
            height: 100%; 
            width: 100%;  
        }
        body.app-loaded { 
            display: block; 
        }


        /* Sidebar */
        .sidebar {
            width: 300px; 
            background: var(--bg-secondary);
            padding: 30px 20px;
            border-right: 1px solid var(--border);
            overflow-y: auto;
            display: flex; 
            flex-direction: column; 
            transition: transform 0.3s ease-in-out;
            z-index: 1100; 
        }

        .logo { 
            font-size: 28px;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo::before {
            content: "üöÄ";
            font-size: 32px;
            -webkit-text-fill-color: initial;
        }
        .sidebar-toggle {
            display: none; 
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1200; 
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 8px 10px;
            font-size: 20px;
            cursor: pointer;
        }

        .nav-menu { list-style: none; }
        .nav-item { margin-bottom: 10px; }
        .nav-link {
            display: flex; align-items: center; gap: 15px; padding: 15px 20px;
            color: var(--text-secondary); text-decoration: none; border-radius: 12px;
            transition: all 0.3s ease; font-weight: 500;
        }
        .nav-link:hover { background: var(--bg-card); color: var(--text-primary); transform: translateX(5px); }
        .nav-link.active { background: var(--gradient); color: white; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); }
        .nav-link:focus { outline: none; }
        
        /* Remove hover effects on touch devices */
        @media (hover: none) and (pointer: coarse) {
            .nav-link:hover { background: transparent; color: var(--text-secondary); transform: none; }
            .nav-link.active:hover { background: var(--gradient); color: white; }
        }
        .nav-icon { font-size: 20px; }

        .user-profile {
            margin-top: auto; padding-top: 30px; border-top: 1px solid var(--border);
            display: flex; align-items: center; gap: 15px;
            flex-shrink: 0; 
        }
        .user-avatar {
            width: 50px; height: 50px; border-radius: 15px; background: var(--gradient);
            display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 20px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 15px 20px;
            overflow-y: auto;
            background: var(--bg-primary);
            transition: margin-left 0.3s ease-in-out;
        }

        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .page-title { font-size: 26px; font-weight: 700; }
        .btn-create {
            background: var(--gradient); color: white; border: none; padding: 9px 22px;
            border-radius: 12px; font-size: 14px; font-weight: 600; cursor: pointer;
            transition: all 0.3s ease; display: flex; align-items: center; gap: 6px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        .btn-create:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4); }

        /* Floating Create Post Section */
        .floating-create {
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .floating-create .btn-create-main {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 14px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }
        .floating-create .btn-create-main:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* Calendar Grid */
        .calendar-container { background: var(--bg-secondary); border-radius: 20px; padding: 20px; margin-bottom: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .month-nav { display: flex; gap: 15px; }
        .month-btn { background: var(--bg-card); border: none; color: var(--text-primary); padding: 8px 16px; border-radius: 10px; cursor: pointer; font-size: 15px; transition: all 0.3s ease; }
        .month-btn:hover { background: var(--accent); }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; }
        .day-header { text-align: center; padding: 6px; color: var(--text-secondary); font-weight: 600; font-size: 14px; }
        .calendar-day {
            height: 65px; background: var(--bg-card); border-radius: 8px; padding: 5px;
            position: relative; cursor: pointer; transition: all 0.3s ease;
            display: flex; flex-direction: column; align-items: center; justify-content: space-between; 
            overflow: hidden;
        }
        .calendar-day:hover { background: #1e2a4a; transform: scale(1.05); }
        .calendar-day.has-post { border: 2px solid #4ade80; padding: 3px;  }
        .calendar-day.has-post:hover { background: #4ade80;  }
        .calendar-day.past-day { 
            background: var(--bg-card); 
            cursor: pointer; 
        }
        .calendar-day.past-day .day-number { 
            color: var(--text-secondary);
            opacity: 0.6;
        }
        .calendar-day.past-day:hover { 
            background: #1a1f2e; 
            transform: scale(1.02); 
        }
        .calendar-day.past-day.has-post { 
            border: 1px solid rgba(74, 222, 128, 0.3); 
        }
        .calendar-day.past-day.has-post:hover { 
            background: rgba(74, 222, 128, 0.05); 
            border-color: rgba(74, 222, 128, 0.5);
        }
        .day-number {
            font-weight: 700; font-size: 13px; position: relative; z-index: 10;
            color: var(--text-primary); text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            align-self: flex-start; margin-left: 2px; margin-top: 2px;
        }
        .post-indicator { display: flex; gap: 4px; z-index: 10; margin-bottom: 4px; flex-wrap: wrap; justify-content: center; }
        .social-dot { width: 8px; height: 8px; border-radius: 50%; }
        .social-dot.vk { background: #4680C2; } .social-dot.fb { background: #1877f2; }
        .social-dot.ok { background: #ee8208; } .social-dot.tg { background: #0088cc; }

        /* Modal */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px); z-index: 1000;
            align-items: center; justify-content: center; overflow-y: auto; padding: 20px 0; 
        }
        .modal.active { display: flex; }
        .modal-content {
            background: var(--bg-secondary); border-radius: 20px; padding: 30px 40px; 
            width: 90%; max-width: 600px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.3s ease; position: relative; 
             max-height: 95vh; 
            overflow-y: auto; 
        }
        .modal-content.large { max-width: 750px; } 
        @keyframes slideIn { from { transform: translateY(-30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .modal-header { font-size: 24px; font-weight: 700; margin-bottom: 25px;  }
        .modal-close-btn {
            position: absolute; top: 20px; right: 25px; background: transparent; border: none;
            color: var(--text-secondary); font-size: 28px; cursor: pointer; line-height: 1;
        }
        .modal-close-btn:hover { color: var(--text-primary); }

        .form-group { margin-bottom: 20px;  }
        .form-label { display: block; margin-bottom: 8px; color: var(--text-secondary); font-weight: 500; }
        .form-textarea {
            width: 100%; min-height: 120px; background: var(--bg-card); border: 2px solid var(--border);
            border-radius: 12px; padding: 15px; color: var(--text-primary); font-size: 16px;
            resize: vertical; transition: all 0.3s ease;
        }
        .form-textarea:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(233, 69, 96, 0.1); }
        .social-selector { display: flex; gap: 15px; flex-wrap: wrap; }
        .social-option { position: relative; }
        .social-checkbox { display: none; }
        .social-label {
            display: flex; align-items: center; gap: 8px; padding: 10px 20px;
            background: var(--bg-card); border: 2px solid var(--border); border-radius: 10px;
            cursor: pointer; transition: all 0.3s ease; font-weight: 500;
        }
        .social-checkbox:checked + .social-label { background: var(--gradient); border-color: transparent; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); }
        .datetime-row { display: flex; gap: 15px; }
        .form-input {
            flex: 1; background: var(--bg-card); border: 2px solid var(--border); border-radius: 10px;
            padding: 12px 15px; color: var(--text-primary); font-size: 16px; transition: all 0.3s ease;
        }
        .form-input:focus { outline: none; border-color: var(--accent); }
        .modal-actions { display: flex; gap: 15px; margin-top: 25px;  }
        .btn { padding: 12px 30px; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; border: none; }
        .btn-primary { background: var(--gradient); color: white; flex: 1; }
        .btn-secondary { background: var(--bg-card); color: var(--text-primary); border: 2px solid var(--border); }
        .btn:hover { transform: translateY(-2px); }

        /* Stats Cards */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .stat-card { background: var(--bg-secondary); border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); transition: all 0.3s ease; }
        .stat-card:hover { transform: translateY(-5px); box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4); }
        .stat-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .stat-title { color: var(--text-secondary); font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }
        .stat-value {
            font-size: 32px; font-weight: 700; margin-bottom: 8px; background: var(--gradient);
            -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
        }
        .stat-change {
            display: inline-flex; align-items: center; gap: 5px; padding: 5px 12px;
            background: rgba(74, 222, 128, 0.1); color: var(--success); border-radius: 20px;
            font-size: 14px; font-weight: 600;
        }
        .stat-change.negative { background: rgba(239, 68, 68, 0.1); color: #ef4444; }

        /* Posts List */
        .posts-list { background: var(--bg-secondary); border-radius: 20px; padding: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); }
        .posts-list.in-modal { background: transparent; box-shadow: none; padding: 0; }
        .post-item {
            display: flex; gap: 12px; padding: 12px; background: var(--bg-card);
            border-radius: 15px; margin-bottom: 10px; transition: transform 0.3s ease, box-shadow 0.3s ease; 
        }
        .posts-list.in-modal .post-item { margin-bottom: 15px; }
        .post-item:hover { transform: translateX(5px); box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3); }
        .posts-list.in-modal .post-item:hover { transform: translateX(3px) scale(1.02); box-shadow: 0 8px 25px rgba(0,0,0,0.35); }
        .post-image {
            width: 70px; height: 70px; border-radius: 12px; background: var(--gradient);
            flex-shrink: 0; background-size: cover; background-position: center;
        }
        .post-image.in-modal-list { width: 50px; height: 50px; border-radius: 8px; }
        .post-content { flex: 1; }
        .post-text {
            color: var(--text-secondary); margin-bottom: 6px; display: -webkit-box;
            -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
            font-size: 13px; line-height: 1.4;
        }
        .post-meta { display: flex; gap: 12px; align-items: center; font-size: 12px; flex-wrap: wrap;  }
        .post-date { color: var(--text-secondary); }
        .post-socials { display: flex; gap: 6px; }
        .post-stats { margin-left: auto; display: flex; align-items: center; gap: 8px; color: var(--text-secondary); }
        .posts-list.in-modal .post-stats { display: none; }
        .post-actions { display: flex; gap: 8px; align-items: center;  }
        .action-btn {
            padding: 6px; background: transparent; border: none; color: var(--text-secondary);
            cursor: pointer; border-radius: 8px; transition: all 0.3s ease; font-size: 16px;
        }
        .action-btn:hover { background: var(--bg-secondary); color: var(--accent); }
        .action-btn.delete-btn:hover { color: #ef4444; }

        /* Pricing Plans */
        .pricing-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 30px; margin-top: 25px; }
        .pricing-card {
            background: var(--bg-secondary); border-radius: 20px; padding: 45px 35px;
            text-align: center; position: relative; transition: all 0.3s ease; border: 2px solid transparent;
        }
        .pricing-card.featured { border-color: var(--accent); transform: scale(1.05); }
        .pricing-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4); }
        .plan-name { font-size: 28px; font-weight: 700; margin-bottom: 15px; }
        .plan-price {
            font-size: 56px; font-weight: 800; margin-bottom: 5px; background: var(--gradient);
            -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
        }
        .plan-period { color: var(--text-secondary); margin-bottom: 30px; font-size: 18px; }
        .plan-features { list-style: none; margin-bottom: 35px; }
        .plan-feature {
            padding: 12px 0; color: var(--text-secondary); display: flex; align-items: center;
            gap: 12px; font-size: 16px; text-align: left; justify-content: center;
        }
        .plan-feature::before { content: "‚úì"; color: var(--success); font-weight: bold; font-size: 18px; }
        .plan-btn {
            width: 100%; padding: 16px; background: var(--bg-card); color: var(--text-primary);
            border: 2px solid var(--border); border-radius: 12px; font-size: 17px; font-weight: 600;
            cursor: pointer; transition: all 0.3s ease;
        }
        .pricing-card.featured .plan-btn { background: var(--gradient); border-color: transparent; color: white; }
        .plan-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); }

        .image-upload {
            position: relative; width: 100%; min-height: 150px; background: var(--bg-card);
            border: 2px dashed var(--border); border-radius: 12px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; overflow: hidden;
        }
        .image-upload:hover { border-color: var(--accent); background: rgba(233, 69, 96, 0.05); }
        .upload-icon { font-size: 48px; margin-bottom: 10px; opacity: 0.5; }
        .uploaded-image-preview { width: 100%; height: 100%; max-height: 200px; object-fit: cover; border-radius: 10px;  }
        .checkbox-group { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .checkbox-group input[type="checkbox"] { width: 20px; height: 20px; accent-color: var(--accent); }
        .radio-group { display: flex; gap: 20px; margin-bottom: 20px; }
        .radio-option { display: flex; align-items: center; gap: 8px; }
        .radio-option input[type="radio"] { width: 18px; height: 18px; accent-color: var(--accent); }
        
        .recurring-options {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }
        .recurring-type {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }
        .recurring-details .datetime-row {
            margin-bottom: 15px;
        }
        .recurring-details .datetime-row:last-child {
            margin-bottom: 0;
        }
        input[type="file"] { display: none; }
        .current-plan-label {
            display: inline-block; padding: 6px 16px; background: var(--success); color: white;
            font-size: 14px; font-weight: 600; border-radius: 20px; margin-bottom: 15px;
        }
        /* Stats page specific grid */
        .stats-posts-grid {
             display: grid;
             grid-template-columns: 1fr 1fr;
             gap: 20px;
             margin-top: 20px;
        }


        /* Mobile Optimizations */
        @media (max-width: 768px) {
            body.app-loaded { 
                display: block; 
            }
             .container.app-view-active { 
                flex-direction: column; 
            }

            .sidebar {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                transform: translateX(-100%);
                width: 80%; 
                max-width: 300px; 
                border-right: 1px solid var(--border); 
                height: 100vh;
                overflow: hidden;
            }
            .sidebar.open {
                transform: translateX(0);
            }
            .sidebar-toggle {
                display: block;
            }
            .main-content {
                margin-left: 0; 
                padding: 60px 15px 15px 15px; 
            }
            .main-content.sidebar-open {
                /* No push needed if sidebar overlays */
            }

            .stats-grid,
            .pricing-grid,
            .header,
            .stats-posts-grid { 
                grid-template-columns: 1fr; 
            }
             .stats-posts-grid { 
                display: flex;
                flex-direction: column;
            }
            .header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            .page-title {
                font-size: 22px;
            }
            .btn-create {
                font-size: 13px;
                padding: 8px 18px;
            }
            .calendar-day {
                height: 55px; 
            }
            .modal-content {
                padding: 25px 20px;
                width: 95%;
            }
            .modal-content.large {
                max-width: 95%;
            }
             .datetime-row {
                flex-direction: column;
            }
        }

    </style>
</head>
<body>

    <div class="login-container" id="loginPage">
        <div class="login-logo">–°—É–ø–µ—Ä–ø–æ—Å—Ç–∏–Ω–≥</div>
        <p class="login-tagline">–í–∞—à —É–º–Ω—ã–π SMM-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö. –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ, —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç –ª–µ–≥–∫–æ!</p>
        <form class="login-form" id="loginForm">
            <div class="form-group">
                <label for="username" class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                <input type="text" id="username" class="form-input" required>
            </div>
            <div class="form-group">
                <label for="password" class="form-label">–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="password" class="form-input" required>
            </div>
            <button type="submit" class="btn-login">–í–æ–π—Ç–∏</button>
            <div class="login-error" id="loginError">–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å.</div>
        </form>
        <p class="login-hint">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –ª–æ–≥–∏–Ω - <strong>admin</strong>, –ø–∞—Ä–æ–ª—å - <strong>admin</strong></p>
    </div>

    <button class="sidebar-toggle" id="sidebarToggle">‚ò∞</button>

    <div class="container" id="appContainer">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="logo">–°—É–ø–µ—Ä–ø–æ—Å—Ç–∏–Ω–≥</div>
            
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" onclick="showSection('calendar')">
                            <span class="nav-icon">üìÖ</span>
                            <span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('stats')">
                            <span class="nav-icon">üìä</span>
                            <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="showSection('pricing')">
                            <span class="nav-icon">üíé</span>
                            <span>–¢–∞—Ä–∏—Ñ—ã</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <span class="nav-icon">üí¨</span>
                            <span>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link">
                            <span class="nav-icon">‚öôÔ∏è</span>
                            <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <div class="user-profile">
                <div class="user-avatar">–ë–ù</div>
                <div>
                    <div style="font-weight: 600;">–ë–µ—Ä–µ–∑–∏–Ω –ù–∏–∫–∏—Ç–∞</div>
                    <div style="font-size: 14px; color: var(--text-secondary);">–¢–∞—Ä–∏—Ñ: –ë–∞–∑–æ–≤—ã–π</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <!-- Calendar Section -->
            <section id="calendar-section">
                <div class="header">
                    <h1 class="page-title">–ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø—É–±–ª–∏–∫–∞—Ü–∏–π</h1>
                </div>

                <div class="calendar-container">
                    <div class="calendar-header">
                        <h2 style="font-size: 20px;" id="calendarMonthTitle">–ú–∞–π 2025</h2>
                        <div class="month-nav">
                            <button class="month-btn" onclick="previousMonth()">‚Üê</button>
                            <button class="month-btn" onclick="nextMonth()">‚Üí</button>
                        </div>
                    </div>

                    <div class="calendar-grid" id="calendarGrid"></div>
                </div>

                <!-- Create Post Section -->
                <div class="floating-create">
                    <button class="btn-create-main" onclick="openPostModal()">
                        <span>‚ú®</span>
                        <span>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç</span>
                    </button>
                </div>

                <!-- Recent Posts -->
                <div class="posts-list" id="recentPostsList">
                    <h2 style="font-size: 20px; margin-bottom: 12px;">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</h2>
                </div>
            </section>

            <!-- Stats Section (Hidden by default) -->
            <section id="stats-section" style="display: none;">
                <div class="header">
                    <h1 class="page-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h1>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">–í—Å–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                            <span class="stat-change">+15.3%</span>
                        </div>
                        <div class="stat-value">254.6K</div>
                        <div style="color: var(--text-secondary);">–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –ø–æ—Å—Ç–æ–≤</span>
                            <span class="stat-change">+8</span>
                        </div>
                        <div class="stat-value">88</div>
                        <div style="color: var(--text-secondary);">–í—Å–µ–≥–æ –∑–∞ –º–µ—Å—è—Ü</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-title">–°—Ä–µ–¥–Ω–∏–π –æ—Ö–≤–∞—Ç</span>
                            <span class="stat-change negative">-2.1%</span>
                        </div>
                        <div class="stat-value">12.4K</div>
                        <div style="color: var(--text-secondary);">–ù–∞ –æ–¥–∏–Ω –ø–æ—Å—Ç</div>
                    </div>
                </div>

                <div class="stats-posts-grid"> 
                    <div class="posts-list">
                        <h2 style="font-size: 20px; margin-bottom: 15px;">–¢–æ–ø –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º</h2>
                        
                        <div class="post-item">
                            <div class="post-image" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                            <div class="post-content">
                                <p class="post-text">üî• –°–∞–º–∞—è –æ–∂–∏–¥–∞–µ–º–∞—è –Ω–æ–≤–∏–Ω–∫–∞ –≥–æ–¥–∞! –ü—Ä–µ–¥–∑–∞–∫–∞–∑ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç.</p>
                                <div class="post-meta">
                                    <span class="post-date">15.05.2025</span>
                                    <div class="post-socials">
                                        <div class="social-dot vk"></div>
                                        <div class="social-dot tg"></div>
                                    </div>
                                    <div class="post-stats">
                                        <span>üëÅ 45.2k</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="post-item">
                            <div class="post-image" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"></div>
                            <div class="post-content">
                                <p class="post-text">üíé –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤!</p>
                                <div class="post-meta">
                                    <span class="post-date">09.05.2025</span>
                                    <div class="post-socials">
                                        <div class="social-dot fb"></div>
                                        <div class="social-dot ok"></div>
                                    </div>
                                    <div class="post-stats">
                                        <span>üëÅ 38.7k</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="post-item">
                            <div class="post-image" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"></div>
                            <div class="post-content">
                                <p class="post-text">üéØ –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∞–∫—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∞—Å!</p>
                                <div class="post-meta">
                                    <span class="post-date">03.05.2025</span>
                                     <div class="post-socials">
                                        <div class="social-dot vk"></div>
                                    </div>
                                    <div class="post-stats">
                                        <span>üëÅ 31.4k</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="post-item">
                            <div class="post-image" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);"></div>
                            <div class="post-content">
                                <p class="post-text">üéâ –ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ —Å–∫–∏–¥–∫–∏ –¥–æ 50%!</p>
                                <div class="post-meta">
                                    <span class="post-date">01.05.2025</span>
                                    <div class="post-socials">
                                        <div class="social-dot vk"></div>
                                        <div class="social-dot fb"></div>
                                        <div class="social-dot ok"></div>
                                        <div class="social-dot tg"></div>
                                    </div>
                                    <div class="post-stats">
                                        <span>üëÅ 28.9k</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="posts-list" id="statsRecentPostsList">
                        <h2 style="font-size: 20px; margin-bottom: 15px;">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—ã</h2>
                        <!-- Posts will be dynamically inserted here -->
                    </div>
                </div>
            </section>

            <!-- Pricing Section (Hidden by default) -->
            <section id="pricing-section" style="display: none;">
                <div class="header">
                    <h1 class="page-title">–¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã</h1>
                </div>

                <div class="pricing-grid">
                    <div class="pricing-card">
                        <h3 class="plan-name">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π</h3>
                        <div class="plan-price">0‚ÇΩ</div>
                        <div class="plan-period">–Ω–∞–≤—Å–µ–≥–¥–∞</div>
                        <ul class="plan-features">
                            <li class="plan-feature">1 —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å</li>
                            <li class="plan-feature">–î–æ 10 –ø–æ—Å—Ç–æ–≤ –≤ –º–µ—Å—è—Ü</li>
                            <li class="plan-feature">–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
                            <li class="plan-feature">–†—É—á–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è</li>
                        </ul>
                        <button class="plan-btn">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ</button>
                    </div>

                    <div class="pricing-card featured">
                        <span class="current-plan-label">–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω</span>
                        <h3 class="plan-name">–ë–∞–∑–æ–≤—ã–π</h3>
                        <div class="plan-price">490‚ÇΩ</div>
                        <div class="plan-period">–≤ –º–µ—Å—è—Ü</div>
                        <ul class="plan-features">
                            <li class="plan-feature">4 —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</li>
                            <li class="plan-feature">–î–æ 100 –ø–æ—Å—Ç–æ–≤ –≤ –º–µ—Å—è—Ü</li>
                            <li class="plan-feature">–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
                            <li class="plan-feature">–ê–≤—Ç–æ–ø—É–±–ª–∏–∫–∞—Ü–∏—è</li>
                            <li class="plan-feature">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–æ—Å—Ç–æ–≤</li>
                        </ul>
                        <button class="plan-btn" disabled style="opacity: 0.6; cursor: not-allowed;">–ê–∫—Ç–∏–≤–µ–Ω –¥–æ 28.06.2025</button>
                    </div>

                    <div class="pricing-card">
                        <h3 class="plan-name">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</h3>
                        <div class="plan-price">990‚ÇΩ</div>
                        <div class="plan-period">–≤ –º–µ—Å—è—Ü</div>
                        <ul class="plan-features">
                            <li class="plan-feature">–í—Å–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</li>
                            <li class="plan-feature">–ë–µ–∑–ª–∏–º–∏—Ç –ø–æ—Å—Ç–æ–≤</li>
                            <li class="plan-feature">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</li>
                            <li class="plan-feature">API –¥–æ—Å—Ç—É–ø</li>
                            <li class="plan-feature">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</li>
                            <li class="plan-feature">–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞</li>
                        </ul>
                        <button class="plan-btn">–£–ª—É—á—à–∏—Ç—å –ø–ª–∞–Ω</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Create/Edit Post Modal -->
    <div class="modal" id="postModal">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closePostModal()">√ó</button>
            <h2 class="modal-header" id="postModalTitle">–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞</h2>
            
            <form id="postForm">
                <input type="hidden" id="editingPostId">
                <input type="hidden" id="editingPostDay">

                <div class="form-group">
                    <label class="form-label">–¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞</label>
                    <textarea id="postText" class="form-textarea" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–∞—à–µ–≥–æ –ø–æ—Å—Ç–∞..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">–î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                    <input type="file" id="imageInput" accept="image/*">
                    <div class="image-upload" id="imageUploadArea">
                        <span class="upload-icon">üì∑</span>
                        <span>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</label>
                    <div class="social-selector">
                        <div class="social-option">
                            <input type="checkbox" id="vk" name="socialNetwork" value="vk" class="social-checkbox">
                            <label for="vk" class="social-label">VK</label>
                        </div>
                        <div class="social-option">
                            <input type="checkbox" id="fb" name="socialNetwork" value="fb" class="social-checkbox">
                            <label for="fb" class="social-label">FB</label>
                        </div>
                        <div class="social-option">
                            <input type="checkbox" id="ok" name="socialNetwork" value="ok" class="social-checkbox">
                            <label for="ok" class="social-label">OK</label>
                        </div>
                        <div class="social-option">
                            <input type="checkbox" id="tg" name="socialNetwork" value="tg" class="social-checkbox">
                            <label for="tg" class="social-label">TG</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">–ö–æ–≥–¥–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="publishNow" name="publishTime" value="now" checked>
                            <label for="publishNow">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="publishScheduled" name="publishTime" value="scheduled">
                            <label for="publishScheduled">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="publishRecurring" name="publishTime" value="recurring">
                            <label for="publishRecurring">–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</label>
                        </div>
                    </div>
                </div>

                <div class="form-group datetime-row" id="datetimeFields" style="display: none;">
                    <input type="date" id="postDate" class="form-input">
                    <input type="time" id="postTime" class="form-input" value="12:00">
                </div>

                <div class="form-group" id="recurringFields" style="display: none;">
                    <label class="form-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</label>
                    <div class="recurring-options">
                        <div class="recurring-type">
                            <label class="form-label" style="margin-bottom: 10px;">–ü–æ–≤—Ç–æ—Ä—è—Ç—å:</label>
                            <div class="radio-group" style="margin-bottom: 15px;">
                                <div class="radio-option">
                                    <input type="radio" id="recurDaily" name="recurType" value="daily" checked>
                                    <label for="recurDaily">–ö–∞–∂–¥—ã–π –¥–µ–Ω—å</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="recurWeekly" name="recurType" value="weekly">
                                    <label for="recurWeekly">–ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="recurCustom" name="recurType" value="custom">
                                    <label for="recurCustom">–ö–∞–∂–¥—ã–µ N –¥–Ω–µ–π</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="recurring-details">
                            <div class="datetime-row">
                                <div>
                                    <label class="form-label">–ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞</label>
                                    <input type="date" id="recurStartDate" class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">–í—Ä–µ–º—è</label>
                                    <input type="time" id="recurTime" class="form-input" value="12:00">
                                </div>
                            </div>
                            
                            <div class="datetime-row" id="customIntervalField" style="display: none;">
                                <div>
                                    <label class="form-label">–ò–Ω—Ç–µ—Ä–≤–∞–ª (–¥–Ω–µ–π)</label>
                                    <input type="number" id="recurInterval" class="form-input" value="1" min="1" max="30">
                                </div>
                                <div>
                                    <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤</label>
                                    <input type="number" id="recurCount" class="form-input" value="5" min="1" max="50">
                                </div>
                            </div>
                            
                            <div class="datetime-row" id="standardRecurField">
                                <div>
                                    <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤</label>
                                    <input type="number" id="recurCountStandard" class="form-input" value="5" min="1" max="50">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closePostModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-primary" onclick="savePost()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Day Posts Modal -->
    <div class="modal" id="dayPostsModal">
        <div class="modal-content large">
             <button class="modal-close-btn" onclick="closeDayPostsModal()">√ó</button>
            <h2 class="modal-header" id="dayPostsModalTitle">–ü—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ –¥–µ–Ω—å</h2>
            <div class="posts-list in-modal" id="dayPostsModalList">
                <!-- Posts for the day will be injected here -->
            </div>
        </div>
    </div>


    <script>
        let uploadedImage = null;
        let posts = {}; 
        const TODAY = new Date(); // –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞
        
        // Calendar navigation variables
        let currentDisplayYear = TODAY.getFullYear();
        let currentDisplayMonth = TODAY.getMonth();
        
        const MONTH_NAMES = [
            '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
            '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
        ];

        let recentPostsDataSource = [ 
            { day: TODAY.getDate() - 3, id: 'stats_post_recent_1', text: 'üöÄ –¢–æ–ª—å–∫–æ 3 –¥–Ω—è! –ú–µ–≥–∞-—Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞ —Å–æ —Å–∫–∏–¥–∫–∞–º–∏ –¥–æ 70% –Ω–∞ –≤—Å–µ –∫—É—Ä—Å—ã!', image: 'gradient_orange_yellow', social: ['vk', 'fb'], time: '10:00', views: '4.8k' },
            { day: TODAY.getDate() - 2, id: 'stats_post_recent_2', text: 'üí° –ù–æ–≤–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –≤–µ—Å–µ–Ω–Ω–∏—Ö –æ–±—Ä–∞–∑–æ–≤ —É–∂–µ –≤ –ø—Ä–æ–¥–∞–∂–µ! –ë—É–¥—å—Ç–µ –≤ —Ç—Ä–µ–Ω–¥–µ!', image: 'gradient_blue_cyan', social: ['vk', 'ok'], time: '11:30', views: '2.3k'  },
            { day: TODAY.getDate() - 1, id: 'stats_post_recent_3', text: 'üì¢ –í–∞–∂–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤: —É–ª—É—á—à–µ–Ω—ã —É—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏!', image: 'gradient_purple_blue', social: ['tg', 'vk'], time: '12:00', views: '1.9k' },
            { day: Math.max(1, TODAY.getDate() - 4), id: 'stats_post_recent_4', text: '‚ú® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!', image: 'gradient_pink_magenta', social: ['ok', 'fb'], time: '13:00', views: '1.2k' }
        ].filter(post => post.day > 0); // –£–±–∏—Ä–∞–µ–º –ø–æ—Å—Ç—ã —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏/–Ω—É–ª–µ–≤—ã–º–∏ –¥–Ω—è–º–∏


        // --- Login Logic ---
        const loginPage = document.getElementById('loginPage');
        const appContainer = document.getElementById('appContainer');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');


        loginForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === 'admin' && password === 'admin') {
                loginPage.style.display = 'none';
                document.body.classList.add('app-loaded'); 
                appContainer.style.display = 'flex'; 
                document.title = "–°—É–ø–µ—Ä–ø–æ—Å—Ç–∏–Ω–≥ - –£–º–Ω—ã–π SMM –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç"; 
                initializeApp(); 
            } else {
                loginError.style.display = 'block';
            }
        });

        sidebarToggle.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });


        // Calendar navigation functions
        function previousMonth() {
            currentDisplayMonth--;
            if (currentDisplayMonth < 0) {
                currentDisplayMonth = 11;
                currentDisplayYear--;
            }
            generateCalendar();
        }
        
        function nextMonth() {
            currentDisplayMonth++;
            if (currentDisplayMonth > 11) {
                currentDisplayMonth = 0;
                currentDisplayYear++;
            }
            generateCalendar();
        }
        
        function generateCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const monthTitle = document.getElementById('calendarMonthTitle');
            
            // Update month title
            monthTitle.textContent = `${MONTH_NAMES[currentDisplayMonth]} ${currentDisplayYear}`;
            
            // Clear calendar
            calendarGrid.innerHTML = '';
            
            // Add day headers
            const dayHeaders = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            dayHeaders.forEach(day => {
                const header = document.createElement('div');
                header.className = 'day-header';
                header.textContent = day;
                calendarGrid.appendChild(header);
            });
            
            // Get first day of month and number of days
            const firstDay = new Date(currentDisplayYear, currentDisplayMonth, 1);
            const lastDay = new Date(currentDisplayYear, currentDisplayMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = (firstDay.getDay() + 6) % 7; // Monday = 0
            
            // Add previous month's trailing days
            const prevMonth = new Date(currentDisplayYear, currentDisplayMonth - 1, 0);
            const daysInPrevMonth = prevMonth.getDate();
            
            for (let i = startingDayOfWeek - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.style.opacity = '0.3';
                dayElement.innerHTML = `<span class="day-number">${day}</span>`;
                calendarGrid.appendChild(dayElement);
            }
            
            // Add current month's days
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.dataset.day = day;
                
                // Check if day is in the past
                const dayDate = new Date(currentDisplayYear, currentDisplayMonth, day);
                const isToday = dayDate.toDateString() === TODAY.toDateString();
                const isPastDay = dayDate < TODAY && !isToday;
                
                if (isPastDay) {
                    dayElement.classList.add('past-day');
                }
                
                dayElement.innerHTML = `
                    <span class="day-number">${day}</span>
                    <div class="post-indicator"></div>
                `;
                
                // Add click event for all days
                dayElement.addEventListener('click', () => {
                    const dayKey = `${currentDisplayYear}-${currentDisplayMonth}-${day}`;
                    if (posts[dayKey] && posts[dayKey].length > 0) {
                        // –ï—Å—Ç—å –ø–æ—Å—Ç—ã - –≤—Å–µ–≥–¥–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª –¥–Ω—è
                        openDayPostsModal(dayKey);
                    } else if (!isPastDay) {
                        // –ù–µ—Ç –ø–æ—Å—Ç–æ–≤ –∏ –¥–µ–Ω—å –Ω–µ –ø—Ä–æ—à–µ–¥—à–∏–π - —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø–æ—Å—Ç
                        openPostModal(null, dayKey);
                    }
                    // –ï—Å–ª–∏ –¥–µ–Ω—å –ø—Ä–æ—à–µ–¥—à–∏–π –∏ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤ - –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
                });
                
                calendarGrid.appendChild(dayElement);
            }
            
            // Add next month's leading days
            const remainingCells = 42 - (startingDayOfWeek + daysInMonth); // 6 rows √ó 7 days
            for (let day = 1; day <= remainingCells; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.style.opacity = '0.3';
                dayElement.innerHTML = `<span class="day-number">${day}</span>`;
                calendarGrid.appendChild(dayElement);
            }
            
            // Update calendar with existing posts
            updateCalendarPosts();
        }
        
        function updateCalendarPosts() {
            Object.keys(posts).forEach(dayKey => {
                if (posts[dayKey] && posts[dayKey].length > 0) {
                    const [year, month, day] = dayKey.split('-').map(Number);
                    if (year === currentDisplayYear && month === currentDisplayMonth) {
                        updateCalendarDayByKey(dayKey);
                    }
                }
            });
        }
        
        function updateCalendarDayByKey(dayKey) {
            const [year, month, day] = dayKey.split('-').map(Number);
            if (year !== currentDisplayYear || month !== currentDisplayMonth) return;
            
            const dayElement = document.querySelector(`.calendar-day[data-day="${day}"]`);
            if (!dayElement) return;

            const dayPosts = posts[dayKey] || [];
            const indicatorContainer = dayElement.querySelector('.post-indicator');
            if (!indicatorContainer) return;
            
            indicatorContainer.innerHTML = '';

            if (dayPosts.length > 0) {
                dayElement.classList.add('has-post');
                const uniqueSocials = new Set();
                dayPosts.forEach(post => post.social.forEach(s => uniqueSocials.add(s)));
                
                uniqueSocials.forEach(social => {
                    const dot = document.createElement('div');
                    dot.className = `social-dot ${social}`;
                    indicatorContainer.appendChild(dot);
                });
            } else {
                dayElement.classList.remove('has-post');
            }
        }

        // --- Modal Management ---
        function openPostModal(postId = null, dayKey = null) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø—ã—Ç–∞–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç –Ω–∞ –ø—Ä–æ—à–µ–¥—à—É—é –¥–∞—Ç—É
            if (!postId && dayKey) {
                const [year, month, day] = dayKey.split('-').map(Number);
                const targetDate = new Date(year, month, day);
                const isToday = targetDate.toDateString() === TODAY.toDateString();
                const isPastDay = targetDate < TODAY && !isToday;
                
                if (isPastDay) {
                    // –ù–µ –ø–æ–∑–≤–æ–ª—è–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã –Ω–∞ –ø—Ä–æ—à–µ–¥—à–∏–µ –¥–Ω–∏
                    return;
                }
            }
            
            const modal = document.getElementById('postModal');
            const title = document.getElementById('postModalTitle');
            const form = document.getElementById('postForm');
            const imageUploadArea = document.getElementById('imageUploadArea');
            
            form.reset(); 
            document.getElementById('editingPostId').value = '';
            document.getElementById('editingPostDay').value = '';
            imageUploadArea.innerHTML = `<span class="upload-icon">üì∑</span><span>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>`;
            uploadedImage = null;
            document.getElementById('publishNow').checked = true; 
            document.getElementById('datetimeFields').style.display = 'none';
            document.getElementById('recurringFields').style.display = 'none';
            document.getElementById('customIntervalField').style.display = 'none';
            document.getElementById('standardRecurField').style.display = 'flex';

            if (postId && dayKey && posts[dayKey]) { // Editing
                const postToEdit = posts[dayKey].find(p => p.id === postId);
                if (postToEdit) {
                    title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞';
                    document.getElementById('editingPostId').value = postId;
                    document.getElementById('editingPostDay').value = dayKey;
                    document.getElementById('postText').value = postToEdit.text;

                    if (postToEdit.image && !postToEdit.image.startsWith('gradient')) { 
                        uploadedImage = postToEdit.image;
                        imageUploadArea.innerHTML = `<img src="${uploadedImage}" class="uploaded-image-preview" alt="Uploaded">`;
                    } else if (postToEdit.image && postToEdit.image.startsWith('gradient')) {
                         imageUploadArea.innerHTML = `<span class="upload-icon">üñºÔ∏è</span><span>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ-–≥—Ä–∞–¥–∏–µ–Ω—Ç (–Ω–µ—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ)</span>`;
                    }

                    postToEdit.social.forEach(socialNetwork => {
                        const checkbox = document.getElementById(socialNetwork);
                        if (checkbox) checkbox.checked = true;
                    });

                    document.getElementById('publishScheduled').checked = true;
                    document.getElementById('datetimeFields').style.display = 'flex';
                    document.getElementById('postDate').value = postToEdit.date;
                    document.getElementById('postTime').value = postToEdit.time;
                    
                    // –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —É–±–∏—Ä–∞–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∞—Ç—ã
                    document.getElementById('postDate').removeAttribute('min');
                }
            } else { // Creating new post
                title.textContent = '–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞';
                let dateToSet;
                if (dayKey) { 
                    const [year, month, day] = dayKey.split('-').map(Number);
                    dateToSet = new Date(year, month, day);
                    document.getElementById('publishScheduled').checked = true; 
                    document.getElementById('datetimeFields').style.display = 'flex';
                } else { 
                    dateToSet = new Date(); 
                    document.getElementById('publishNow').checked = true; 
                    document.getElementById('datetimeFields').style.display = 'none';
                }
                
                // –í–°–ï–ì–î–ê —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É –∫–∞–∫ —Å–µ–≥–æ–¥–Ω—è –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤
                const today = new Date();
                const todayStr = today.toISOString().split('T')[0];
                document.getElementById('postDate').setAttribute('min', todayStr);
                
                const year = dateToSet.getFullYear();
                const month = String(dateToSet.getMonth() + 1).padStart(2, '0');
                const dayOfMonthStr = String(dateToSet.getDate()).padStart(2, '0');
                document.getElementById('postDate').value = `${year}-${month}-${dayOfMonthStr}`;
                document.getElementById('postTime').value = new Date().toTimeString().slice(0,5); 
            }
            modal.classList.add('active');
        }

        function closePostModal() {
            document.getElementById('postModal').classList.remove('active');
            document.getElementById('postForm').reset();
            document.getElementById('imageUploadArea').innerHTML = `
                <span class="upload-icon">üì∑</span>
                <span>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
            `;
            uploadedImage = null;
            document.getElementById('editingPostId').value = '';
            document.getElementById('editingPostDay').value = '';
            
            // –°–±—Ä–æ—Å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ–ª–µ–π
            document.getElementById('datetimeFields').style.display = 'none';
            document.getElementById('recurringFields').style.display = 'none';
            document.getElementById('customIntervalField').style.display = 'none';
            document.getElementById('standardRecurField').style.display = 'flex';
        }

        function openDayPostsModal(dayKey) {
            const modal = document.getElementById('dayPostsModal');
            const title = document.getElementById('dayPostsModalTitle');
            const listElement = document.getElementById('dayPostsModalList');
            listElement.innerHTML = ''; 

            const dayPosts = posts[dayKey] || [];
            const [year, month, day] = dayKey.split('-').map(Number);
            const dateForTitle = new Date(year, month, day).toLocaleDateString('ru-RU', {day: 'numeric', month: 'long'});
            title.textContent = `–ü—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ ${dateForTitle}`;

            if (dayPosts.length === 0) {
                listElement.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">–ù–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π.</p>';
            } else {
                dayPosts.forEach(post => {
                    const postItem = createPostListItem(post, dayKey, true); 
                    listElement.appendChild(postItem);
                });
            }
            modal.classList.add('active');
        }

        function updateDayPostsModal(dayKey) {
            const listElement = document.getElementById('dayPostsModalList');
            listElement.innerHTML = '';

            const dayPosts = posts[dayKey] || [];
            
            if (dayPosts.length === 0) {
                listElement.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">–ù–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π.</p>';
            } else {
                dayPosts.forEach(post => {
                    const postItem = createPostListItem(post, dayKey, true);
                    listElement.appendChild(postItem);
                });
            }
        }

        function closeDayPostsModal() {
            document.getElementById('dayPostsModal').classList.remove('active');
        }


        document.getElementById('imageUploadArea').addEventListener('click', () => {
            if (document.getElementById('editingPostId').value) {
                 const postId = document.getElementById('editingPostId').value;
                 const postDay = parseInt(document.getElementById('editingPostDay').value);
                 const postToEdit = posts[postDay]?.find(p => p.id === postId);
                 if (postToEdit && postToEdit.image && postToEdit.image.startsWith('gradient')) {
                    return;
                 }
            }
            document.getElementById('imageInput').click();
        });

        document.getElementById('imageInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    uploadedImage = event.target.result;
                    document.getElementById('imageUploadArea').innerHTML = `
                        <img src="${uploadedImage}" class="uploaded-image-preview" alt="Uploaded">
                    `;
                };
                reader.readAsDataURL(file);
            }
        });

        document.querySelectorAll('input[name="publishTime"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const datetimeFields = document.getElementById('datetimeFields');
                const recurringFields = document.getElementById('recurringFields');
                const postDateInput = document.getElementById('postDate');
                const recurStartDateInput = document.getElementById('recurStartDate');
                
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –ø–æ–ª—è
                datetimeFields.style.display = 'none';
                recurringFields.style.display = 'none';
                
                if (this.value === 'scheduled') {
                    datetimeFields.style.display = 'flex';
                    
                    // –ï—Å–ª–∏ —ç—Ç–æ –Ω–æ–≤—ã–π –ø–æ—Å—Ç, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º min –¥–∞—Ç—É
                    if (!document.getElementById('editingPostId').value) {
                        const today = new Date();
                        const todayStr = today.toISOString().split('T')[0];
                        postDateInput.setAttribute('min', todayStr);
                        
                        if (postDateInput.value && postDateInput.value < todayStr) {
                            postDateInput.value = todayStr;
                        }
                    }
                } else if (this.value === 'recurring') {
                    recurringFields.style.display = 'block';
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø–æ—Å—Ç–æ–≤
                    if (!document.getElementById('editingPostId').value) {
                        const today = new Date();
                        const todayStr = today.toISOString().split('T')[0];
                        recurStartDateInput.setAttribute('min', todayStr);
                        recurStartDateInput.value = todayStr;
                    }
                }
            });
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ç–∏–ø–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
        document.querySelectorAll('input[name="recurType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const customField = document.getElementById('customIntervalField');
                const standardField = document.getElementById('standardRecurField');
                
                if (this.value === 'custom') {
                    customField.style.display = 'flex';
                    standardField.style.display = 'none';
                } else {
                    customField.style.display = 'none';
                    standardField.style.display = 'flex';
                }
            });
        });

        function generatePostId() {
            return 'post_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function savePost() {
            const text = document.getElementById('postText').value;
            const publishType = document.querySelector('input[name="publishTime"]:checked').value;
            
            const socialNetworks = Array.from(document.querySelectorAll('.social-checkbox:checked')).map(cb => cb.value);

            if (!text.trim() || socialNetworks.length === 0) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Å–æ—Ü–∏–∞–ª—å–Ω—É—é —Å–µ—Ç—å.');
                return;
            }

            const editingPostId = document.getElementById('editingPostId').value;
            const editingPostDayKey = document.getElementById('editingPostDay').value;

            if (editingPostId && editingPostDayKey && posts[editingPostDayKey]) {
                // –õ–æ–≥–∏–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ—Å—Ç–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–µ–π
                editExistingPost(editingPostId, editingPostDayKey, text, socialNetworks, publishType);
            } else {
                // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞
                if (publishType === 'now') {
                    createSinglePost(text, socialNetworks, new Date(), new Date().toTimeString().slice(0, 5));
                } else if (publishType === 'scheduled') {
                    const date = document.getElementById('postDate').value;
                    const time = document.getElementById('postTime').value;
                    
                    if (validatePostDate(date)) {
                        createSinglePost(text, socialNetworks, new Date(date), time);
                    } else {
                        return;
                    }
                } else if (publishType === 'recurring') {
                    createRecurringPosts(text, socialNetworks);
                }
            }
            
            renderRecentPosts(); 
            renderStatsRecentPosts(); 
            closePostModal();
            updateCalendarPosts();
        }

        function validatePostDate(dateStr) {
            const selectedDate = new Date(dateStr);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            selectedDate.setHours(0, 0, 0, 0);
            
            if (selectedDate < today) {
                alert('–ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã –Ω–∞ –ø—Ä–æ—à–µ–¥—à–∏–µ –¥–∞—Ç—ã. –í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å –∏–ª–∏ –±—É–¥—É—â—É—é –¥–∞—Ç—É.');
                return false;
            }
            return true;
        }

        function createSinglePost(text, socialNetworks, dateObj, time) {
            const date = dateObj.toISOString().split('T')[0];
            const dayKey = `${dateObj.getFullYear()}-${dateObj.getMonth()}-${dateObj.getDate()}`;
            
            const newPost = {
                id: generatePostId(),
                text: text,
                image: uploadedImage,
                date: date,
                time: time,
                social: socialNetworks,
                views: '0' 
            };
            
            if (!posts[dayKey]) {
                posts[dayKey] = [];
            }
            posts[dayKey].push(newPost);
            updateCalendarDayByKey(dayKey);
        }

        function createRecurringPosts(text, socialNetworks) {
            const startDate = new Date(document.getElementById('recurStartDate').value);
            const time = document.getElementById('recurTime').value;
            const recurType = document.querySelector('input[name="recurType"]:checked').value;
            
            let interval = 1; // –¥–Ω–µ–π
            let count = parseInt(document.getElementById('recurCountStandard').value);
            
            if (recurType === 'daily') {
                interval = 1;
            } else if (recurType === 'weekly') {
                interval = 7;
            } else if (recurType === 'custom') {
                interval = parseInt(document.getElementById('recurInterval').value);
                count = parseInt(document.getElementById('recurCount').value);
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—É—é –¥–∞—Ç—É
            if (!validatePostDate(document.getElementById('recurStartDate').value)) {
                return;
            }

            let createdCount = 0;
            const maxPosts = Math.min(count, 50); // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º—É–º 50 –ø–æ—Å—Ç–∞–º–∏

            for (let i = 0; i < maxPosts; i++) {
                const postDate = new Date(startDate);
                postDate.setDate(startDate.getDate() + (i * interval));
                
                // –°–æ–∑–¥–∞–µ–º –ø–æ—Å—Ç —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
                const dayKey = `${postDate.getFullYear()}-${postDate.getMonth()}-${postDate.getDate()}`;
                const newPost = {
                    id: generatePostId(),
                    text: `${text} ${i > 0 ? `(#${i + 1})` : ''}`,
                    image: uploadedImage,
                    date: postDate.toISOString().split('T')[0],
                    time: time,
                    social: [...socialNetworks],
                    views: '0',
                    isRecurring: true,
                    recurringGroup: `group_${Date.now()}`
                };
                
                if (!posts[dayKey]) {
                    posts[dayKey] = [];
                }
                posts[dayKey].push(newPost);
                updateCalendarDayByKey(dayKey);
                createdCount++;
            }

            alert(`–°–æ–∑–¥–∞–Ω–æ ${createdCount} –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π!`);
        }

        function editExistingPost(editingPostId, editingPostDayKey, text, socialNetworks, publishType) {
            const postIndex = posts[editingPostDayKey].findIndex(p => p.id === editingPostId);
            if (postIndex > -1) {
                const originalPost = posts[editingPostDayKey][postIndex];
                
                let date, time;
                if (publishType === 'now') {
                    const now = new Date();
                    date = now.toISOString().split('T')[0];
                    time = now.toTimeString().slice(0, 5);
                } else if (publishType === 'scheduled') {
                    date = document.getElementById('postDate').value;
                    time = document.getElementById('postTime').value;
                } else {
                    // –î–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø–æ—Å—Ç–æ–≤ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
                    date = originalPost.date;
                    time = originalPost.time;
                }
                
                const dateObj = new Date(date);
                const dayKey = `${dateObj.getFullYear()}-${dateObj.getMonth()}-${dateObj.getDate()}`;
                
                const updatedPost = {
                    ...originalPost,
                    text: text,
                    image: uploadedImage || originalPost.image, 
                    date: date,
                    time: time,
                    social: socialNetworks,
                    views: originalPost.views 
                };

                if (dayKey !== editingPostDayKey) {
                    posts[editingPostDayKey].splice(postIndex, 1); 
                    if (!posts[editingPostDayKey] || posts[editingPostDayKey].length === 0) {
                         delete posts[editingPostDayKey]; 
                    }
                    updateCalendarDayByKey(editingPostDayKey); 

                    if (!posts[dayKey]) posts[dayKey] = [];
                    posts[dayKey].push(updatedPost);
                } else {
                    posts[editingPostDayKey][postIndex] = updatedPost;
                }
                
                updateCalendarDayByKey(dayKey);
                if (dayKey !== editingPostDayKey) {
                    updateCalendarDayByKey(editingPostDayKey); 
                }

                // Update day posts modal if it's open
                if (document.getElementById('dayPostsModal').classList.contains('active')) {
                    const activeDayText = document.getElementById('dayPostsModalTitle').textContent;
                    const activeDayMatch = activeDayText.match(/(\d+)\s+\w+/); 
                    if (activeDayMatch && activeDayMatch[1]) {
                        const activeDay = parseInt(activeDayMatch[1]);
                        const activeDayKey = `${currentDisplayYear}-${currentDisplayMonth}-${activeDay}`;
                        if(activeDayKey === dayKey || activeDayKey === editingPostDayKey){
                            updateDayPostsModal(activeDayKey);
                        }
                    }
                }
            }
        }

        function deletePost(postId, dayKey) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–æ—Å—Ç?')) {
                let postFoundAndRemoved = false;
                
                // Remove from main 'posts' object
                if (posts[dayKey]) {
                    const initialLength = posts[dayKey].length;
                    posts[dayKey] = posts[dayKey].filter(p => p.id !== postId);
                    if (posts[dayKey].length < initialLength) {
                        postFoundAndRemoved = true;
                    }
                    if (posts[dayKey].length === 0) {
                        delete posts[dayKey];
                    }
                }
                
                // Also remove from recentPostsDataSource if it exists there by ID
                const recentPostIndex = recentPostsDataSource.findIndex(rp => rp.id === postId);
                if (recentPostIndex > -1) {
                    recentPostsDataSource.splice(recentPostIndex, 1);
                    postFoundAndRemoved = true;
                }

                // Always update UI regardless of where the post was found
                updateCalendarDayByKey(dayKey);
                renderRecentPosts();
                renderStatsRecentPosts();

                // Update day posts modal if it's open - IMMEDIATELY
                if (document.getElementById('dayPostsModal').classList.contains('active')) {
                    updateDayPostsModal(dayKey);
                }

                if (!postFoundAndRemoved) {
                    console.warn("Post to delete not found:", postId, "on dayKey", dayKey);
                }
            }
        }

        function createPostListItem(postData, dayKey, inModal = false) {
            const postItem = document.createElement('div');
            postItem.className = 'post-item';
            postItem.dataset.postId = postData.id; 
            postItem.dataset.dayKey = dayKey; 

            const dateObj = new Date(postData.date);
            let formattedDate = "Invalid Date";
            if (!isNaN(dateObj.getTime())) { 
                 formattedDate = dateObj.toLocaleDateString('ru-RU', {
                    day: '2-digit', month: '2-digit', year: 'numeric'
                });
            }
            
            let imageHtml = '';
            let gradientStyle = 'var(--gradient)'; 

            if (postData.image && !postData.image.startsWith('gradient')) {
                imageHtml = `<div class="post-image ${inModal ? 'in-modal-list' : ''}" style="background-image: url(${postData.image})"></div>`;
            } else { 
                if (postData.image === 'gradient_orange_yellow') gradientStyle = 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)';
                else if (postData.image === 'gradient_blue_cyan') gradientStyle = 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)';
                else if (postData.image === 'gradient_purple_blue') gradientStyle = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                else if (postData.image === 'gradient_pink_magenta') gradientStyle = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
                else if (postData.image === 'gradient1') gradientStyle = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
                else if (postData.image === 'gradient2') gradientStyle = 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)';
                
                imageHtml = `<div class="post-image ${inModal ? 'in-modal-list' : ''}" style="background: ${gradientStyle};"></div>`;
            }
            
            let socialHtml = '';
            if(postData.social && Array.isArray(postData.social)){
                postData.social.forEach(social => {
                    socialHtml += `<div class="social-dot ${social}"></div>`;
                });
            }

            const views = postData.views !== undefined ? postData.views : '0'; 
            const statsHtml = !inModal ? `<div class="post-stats"><span>üëÅ ${views}</span></div>` : '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –ø–æ—Å—Ç–∞
            const recurringIndicator = postData.isRecurring ? '<span style="color: var(--warning); font-size: 12px;">üîÑ –°–µ—Ä–∏—è</span>' : '';
            
            postItem.innerHTML = `
                ${imageHtml}
                <div class="post-content">
                    <p class="post-text">${postData.text || ''}</p>
                    <div class="post-meta">
                        <span class="post-date">${formattedDate} ‚Ä¢ ${postData.time || ''}</span>
                        ${recurringIndicator}
                        <div class="post-socials">
                            ${socialHtml}
                        </div>
                        ${statsHtml}
                    </div>
                </div>
                <div class="post-actions">
                    <button class="action-btn edit-btn">‚úèÔ∏è</button>
                    <button class="action-btn delete-btn">üóëÔ∏è</button>
                </div>
            `;
            
            postItem.querySelector('.edit-btn').addEventListener('click', (e) => {
                e.stopPropagation(); 
                const pId = postItem.dataset.postId;
                const pDayKey = postItem.dataset.dayKey;
                openPostModal(pId, pDayKey);
                if (inModal) closeDayPostsModal(); 
            });
            postItem.querySelector('.delete-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                const pId = postItem.dataset.postId;
                const pDayKey = postItem.dataset.dayKey;
                deletePost(pId, pDayKey);
            });

            return postItem;
        }


        function renderRecentPosts() {
            const postsListContainer = document.getElementById('recentPostsList');
            // Remove all posts except the title
            while (postsListContainer.children.length > 1) {
                postsListContainer.removeChild(postsListContainer.lastChild);
            }

            // Collect all posts from the posts object
            const allPosts = [];
            Object.keys(posts).forEach(dayKey => {
                posts[dayKey].forEach(post => {
                    allPosts.push({
                        ...post,
                        dayKey: dayKey
                    });
                });
            });

            // Sort by date (newest first)
            allPosts.sort((a, b) => {
                const dateA = new Date(a.date + ' ' + a.time);
                const dateB = new Date(b.date + ' ' + b.time);
                return dateB - dateA;
            });

            // Show only the last 4 posts
            const recentPosts = allPosts.slice(0, 4);

            if (recentPosts.length === 0) {
                const emptyMessage = document.createElement('p');
                emptyMessage.style.textAlign = 'center';
                emptyMessage.style.color = 'var(--text-secondary)';
                emptyMessage.style.padding = '20px';
                emptyMessage.textContent = '–ü–æ–∫–∞ –Ω–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–π';
                postsListContainer.appendChild(emptyMessage);
                return;
            }

            recentPosts.forEach(post => {
                const listItem = createPostListItem(post, post.dayKey);
                postsListContainer.appendChild(listItem);
            });
        }
        
        function renderStatsRecentPosts() {
            const postsListContainer = document.getElementById('statsRecentPostsList');
            if (!postsListContainer) return;
            
            // Remove all posts except the title
            while (postsListContainer.children.length > 1) {
                postsListContainer.removeChild(postsListContainer.lastChild);
            }

            // Collect all posts from the posts object
            const allPosts = [];
            Object.keys(posts).forEach(dayKey => {
                posts[dayKey].forEach(post => {
                    allPosts.push({
                        ...post,
                        dayKey: dayKey
                    });
                });
            });

            // Sort by date (newest first)
            allPosts.sort((a, b) => {
                const dateA = new Date(a.date + ' ' + a.time);
                const dateB = new Date(b.date + ' ' + b.time);
                return dateB - dateA;
            });

            // Show only the last 4 posts
            const recentPosts = allPosts.slice(0, 4);

            if (recentPosts.length === 0) {
                const emptyMessage = document.createElement('p');
                emptyMessage.style.textAlign = 'center';
                emptyMessage.style.color = 'var(--text-secondary)';
                emptyMessage.style.padding = '20px';
                emptyMessage.textContent = '–ü–æ–∫–∞ –Ω–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–π';
                postsListContainer.appendChild(emptyMessage);
                return;
            }

            recentPosts.forEach(post => {
                const listItem = createPostListItem(post, post.dayKey);
                // Remove action buttons for stats view
                listItem.querySelector('.post-actions').innerHTML = '';
                postsListContainer.appendChild(listItem);
            });
        }

        function initializeApp() {
            posts = {}; 

            const defaultTexts = {
                "initial_post_5_1": "–î–µ–ª–∏–º—Å—è –ø–æ–¥–±–æ—Ä–∫–æ–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Ñ–∞–∫—Ç–æ–≤ –æ –∫–æ—Å–º–æ—Å–µ! –£–∑–Ω–∞–π—Ç–µ –±–æ–ª—å—à–µ –æ –∑–≤–µ–∑–¥–∞—Ö –∏ –ø–ª–∞–Ω–µ—Ç–∞—Ö.",
                "initial_post_9_1": "–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –Ω–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —á–µ—Å—Ç—å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞! –°–∫–∏–¥–∫–∏ –¥–æ 30%.",
                "initial_post_15_1": "–ù–æ–≤–∞—è –≤–µ—Å–µ–Ω–Ω—è—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —É–∂–µ –≤ –ø—Ä–æ–¥–∞–∂–µ! –Ø—Ä–∫–∏–µ —Ü–≤–µ—Ç–∞ –∏ —Å—Ç–∏–ª—å–Ω—ã–µ –æ–±—Ä–∞–∑—ã. –£—Å–ø–µ–π—Ç–µ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏.",
                "initial_post_16_1": "–í–∞–∂–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: —É–ª—É—á—à–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞.",
                "initial_post_24_1": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∫ –ø—Ä–æ—á—Ç–µ–Ω–∏—é: –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π —Ä–æ–º–∞–Ω –æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö –∏ —Ç–∞–π–Ω–∞—Ö –¥—Ä–µ–≤–Ω–∏—Ö —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–π."
            };

            const uniquePostTexts = [
                "üéØ –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É! –°—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ 3 –¥–Ω—è!",
                "üíé –ü—Ä–µ–º–∏—É–º –ø–æ–¥–ø–∏—Å–∫–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π 50%! –¢–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö 100 –∫–ª–∏–µ–Ω—Ç–æ–≤!",
                "üî• –ò–Ω—Ç–µ–Ω—Å–∏–≤ –ø–æ –¥–∏–∑–∞–π–Ω—É –æ—Ç —Ç–æ–ø–æ–≤—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤! –ú–µ—Å—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã!",
                "‚≠ê –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ —Å —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã!",
                "üöÄ –ù–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç –∑–∞–ø—É—â–µ–Ω! –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º–∏, –∫—Ç–æ –µ–≥–æ –ø–æ–ø—Ä–æ–±—É–µ—Ç!",
                "üí∞ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –≤–µ–±–∏–Ω–∞—Ä –æ—Ç –≤–µ–¥—É—â–∏—Ö –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤!",
                "üé® –ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –≤–æ—Ä–∫—à–æ–ø –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è —Ç–≤–æ—Ä—á–µ—Å–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤!",
                "üìà –ë–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ–Ω—Å–∏–≤: —É–¥–≤–æ–π—Ç–µ –¥–æ—Ö–æ–¥—ã –∑–∞ 30 –¥–Ω–µ–π!"
            ];

            const pastPostTexts = [
                "üìä –ò—Ç–æ–≥–∏ –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è - —Å–ø–∞—Å–∏–±–æ –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º!",
                "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –∫–æ–Ω–∫—É—Ä—Å–∞! –ü—Ä–∏–∑—ã —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã.",
                "üíº –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∑–∞ –ø—Ä–æ—à–µ–¥—à—É—é –Ω–µ–¥–µ–ª—é.",
                "üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–æ—Å—Ç–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü –ø—Ä–µ–≤–∑–æ—à–ª–∞ –æ–∂–∏–¥–∞–Ω–∏—è!",
                "üèÜ –ü–æ–ª—É—á–∏–ª–∏ –Ω–∞–≥—Ä–∞–¥—É '–õ—É—á—à–∏–π —Å—Ç–∞—Ä—Ç–∞–ø –≥–æ–¥–∞'!",
                "ü§ù –ó–∞–∫–ª—é—á–∏–ª–∏ –≤–∞–∂–Ω–æ–µ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ.",
                "üìù –û–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—à–µ–º—É –ø—Ä–æ–¥—É–∫—Ç—É."
            ];

            // Create some sample posts for current month
            const currentYear = TODAY.getFullYear();
            const currentMonth = TODAY.getMonth();
            const currentDay = TODAY.getDate();

            // Add some demo posts for past days
            const pastDays = [];
            for (let i = 1; i < currentDay; i++) {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ –≤–æ –≤—Å–µ –¥–Ω–∏, –∞ –≤—ã–±–æ—Ä–æ—á–Ω–æ
                if (Math.random() > 0.7) { // 30% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —á—Ç–æ –≤ –¥–µ–Ω—å –µ—Å—Ç—å –ø–æ—Å—Ç
                    pastDays.push(i);
                }
            }

            pastDays.forEach((day, index) => {
                const dayKey = `${currentYear}-${currentMonth}-${day}`;
                const social = [['vk'], ['vk', 'fb'], ['vk', 'ok'], ['tg'], ['fb', 'ok']][index % 5];
                const postDate = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                if (!posts[dayKey]) {
                    posts[dayKey] = [];
                }
                
                const views = Math.floor(Math.random() * 8000) + 1000;
                const viewsFormatted = views > 1000 ? (views / 1000).toFixed(1) + 'k' : views.toString();
                
                posts[dayKey].push({
                    id: `past_post_${day}_${index}`,
                    text: pastPostTexts[index % pastPostTexts.length],
                    image: index % 3 === 0 ? ['gradient1', 'gradient2', 'gradient_orange_yellow'][index % 3] : null,
                    date: postDate,
                    time: ['09:00', '12:00', '15:00', '18:00'][index % 4],
                    social: social,
                    views: viewsFormatted
                });
            });

            // Add some demo posts for future days
            const futureDays = [currentDay + 1, currentDay + 3, currentDay + 7, currentDay + 10, currentDay + 14].filter(day => {
                const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
                return day <= daysInMonth;
            });

            futureDays.forEach((day, index) => {
                const dayKey = `${currentYear}-${currentMonth}-${day}`;
                const social = [['vk'], ['vk', 'fb'], ['vk', 'fb', 'ok'], ['tg'], ['vk', 'ok']][index % 5];
                const postDate = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                if (!posts[dayKey]) {
                    posts[dayKey] = [];
                }
                
                const views = Math.floor(Math.random() * 5000) + 500;
                const viewsFormatted = views > 1000 ? (views / 1000).toFixed(1) + 'k' : views.toString();
                
                posts[dayKey].push({
                    id: `demo_post_${day}_${index}`,
                    text: uniquePostTexts[index % uniquePostTexts.length],
                    image: index % 2 === 0 ? ['gradient1', 'gradient2'][index % 2] : null,
                    date: postDate,
                    time: '12:00',
                    social: social,
                    views: viewsFormatted
                });
            });

            // Convert recentPostsDataSource to new system (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –≤ –ø—Ä–æ—à–ª–æ–º)
            recentPostsDataSource.forEach(rpData => {
                const dayKey = `${currentYear}-${currentMonth}-${rpData.day}`;
                if (!posts[dayKey]) {
                    posts[dayKey] = [];
                }
                const existingPostIndex = posts[dayKey].findIndex(p => p.id === rpData.id);
                const postObject = {
                    id: rpData.id,
                    text: rpData.text,
                    image: rpData.image,
                    date: `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(rpData.day).padStart(2, '0')}`,
                    time: rpData.time,
                    social: rpData.social,
                    views: rpData.views
                };
                if (existingPostIndex > -1) {
                    posts[dayKey][existingPostIndex] = postObject;
                } else {
                     posts[dayKey].push(postObject);
                }
            });
            
            // Generate calendar
            generateCalendar();

            renderRecentPosts(); 
            renderStatsRecentPosts();
        
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        if (this.id === 'postModal') closePostModal();
                        if (this.id === 'dayPostsModal') closeDayPostsModal();
                    }
                });
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π
            document.querySelectorAll('input[name="recurType"]').forEach(radio => {
                if (!radio.hasAttribute('data-handler-added')) {
                    radio.addEventListener('change', function() {
                        const customField = document.getElementById('customIntervalField');
                        const standardField = document.getElementById('standardRecurField');
                        
                        if (this.value === 'custom') {
                            customField.style.display = 'flex';
                            standardField.style.display = 'none';
                        } else {
                            customField.style.display = 'none';
                            standardField.style.display = 'flex';
                        }
                    });
                    radio.setAttribute('data-handler-added', 'true');
                }
            });

            // Remove hover effects on touch devices after click
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function() {
                    // Force remove focus and blur on mobile
                    this.blur();
                    // Remove any active states on mobile
                    if (window.matchMedia('(hover: none) and (pointer: coarse)').matches) {
                        setTimeout(() => {
                            this.style.background = '';
                            this.style.color = '';
                            this.style.transform = '';
                        }, 10);
                    }
                });
            });
        }
        
        function showSection(section) {
            document.getElementById('calendar-section').style.display = 'none';
            document.getElementById('stats-section').style.display = 'none';
            document.getElementById('pricing-section').style.display = 'none';
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                link.blur(); 
            });
            
            const sectionElement = document.getElementById(section + '-section');
            const navLink = document.querySelector(`.nav-link[onclick="showSection('${section}')"]`);

            if (sectionElement) sectionElement.style.display = 'block';
            if (navLink) navLink.classList.add('active');

            if (window.innerWidth <= 768) {
                sidebar.classList.remove('open');
            }
        }
    </script>
</body>
</html>